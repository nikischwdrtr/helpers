import LCD_1in44
import cv2,os,shutil,time
from PIL import Image

videoFile = "test.mp4"
frameRate = 30

if os.path.exists('frames'):
    shutil.rmtree("frames")

def extract_frames(videoFile,frameRate):
    cap = cv2.VideoCapture(videoFile)
    frame_count = 0
    video_name = os.path.splitext(os.path.basename(videoFile))[0]
    os.makedirs("frames")
    while True:
        ret, frame = cap.read()
        if not ret:
            break
        frame_count += 1
        if frame_count % int(cap.get(5) / frameRate) == 0:
            output_file = "{:07d}".format(frame_count)
            output_file = 'frames/'+output_file+'.jpg'
            cv2.imwrite(output_file, frame)
    cap.release()
    cv2.destroyAllWindows()
def showFrames():
    frames = os.listdir('frames')
    frames.sort()
    loop = True
    while(loop):
        for x in frames:
            image = Image.open('frames/'+x)
            print(x)
            LCD.LCD_ShowImage(image,0,0)
            # image.show()
            time.sleep(1/frameRate)

# run functions
extract_frames(videoFile,frameRate)
showFrames()
